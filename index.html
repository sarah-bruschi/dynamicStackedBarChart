<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>CSV-Excel 2 JSON Demo</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.9/css/mdb.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script  src="https://code.jquery.com/jquery-3.4.1.min.js"  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="  crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.3/jquery.csv.min.js"></script>
  <script type="text/javascript" lang="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.1/xlsx.full.min.js"></script>
  <script type="text/javascript" src="./script.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script type="text/javascript" src='https://cdn.plot.ly/plotly-latest.min.js'></script>
  

</head>
<body>
  <div class="p-3" style="width: 100hw; padding: 1rem">
    <h2>Excel File Data</h2>
    <table class="table table-sm table-bordered ">
      <thead class="thead-dark">
            <tr>
                <th>Title</th>
                <th>Artist Name</th>
                <th>Top Genre</th>
                <th>Year</th>
                <th>BPM</th>
            </tr>
        </thead>
        <tbody id="showExcel"></tbody>
    </table>
</div>
<div id="plot">

</div>
</body>



<script>
  $(function() {

  var colors = ['##FF6633', '##4D80CC', '##FF33FF', '##FFFF99', '##00B3E6',
'##E6B333', '##3366E6', '##999966', '##99FF99', '##B34D4D',
  '##80B300', '##809900', '##E6B3B3', '##6680B3', '##66991A',
'##FF99E6', '##CCFF1A', '##FF1A66', '##E6331A', '##33FFCC',
  '##66994D', '##B366CC', '##4D8000', '##B33300', '##CC80CC',
'##66664D', '##991AFF', '##E666FF', '##4DB3FF', '##1AB399',
  '##E666B3', '##33991A', '##CC9999', '##B3B31A', '##00E680',
'##4D8066', '##809980', '##E6FF80', '##1AFF33', '##999933',
  '##FF3380', '##CCCC00', '##66E64D', '##4D80CC', '##9900B3',
'##E64D66', '##4DB380', '##FF4D4D', '##99E6E6', '##6666FF'];

arrTrace = [];


for (i = 0; i < titles.length; i++) {
  var  trace   = {
                x: [titles[i]],
                y: [bpm.val(i)],
                name: [artist.val(i)],
                type:'bar',
                marker: {
                    color: 'colors[i]',
                        opacity: 0.7
                    }
            };
 arrTrace[i] = trace; 
}

var data = arrTrace;

layout = {
    title: {
        text:'Top 100 songs bpm',
        font: {
            family: 'Helvetica Neue, Helvetica, Arial, sans-serif',
            size: 24
        },
        xref: 'paper',
        x: 0
    },
    legend: {
        x: 0,
        y: 1.15,
        "orientation": "h"},
    barmode: 'stack',
    xaxis: {tickangle: 0,
        showgrid: false,
        zeroline: false,
        showline: false
    },
    yaxis: {
        showticklabels: false,
        showgrid: false,
        zeroline: false,
        showline: false

    }

};

var config = {responsive: true};


Plotly.newPlot('Plot', data, layout, {displaylogo: false}, config);
  });